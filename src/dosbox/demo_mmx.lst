     1                                  ; Assemble with: nasm -f bin -o demo_mmx.com demo_mmx.asm -l demo_mmx.lst
     2                                  
     3                                      ; 16-bit code
     4                                      BITS 16
     5                                       ; COM programs start at offset 100h
     6                                      ORG 100h
     7                                  
     8                                  start:
     9                                      ; Set video mode (320x200, 256 colors)
    10 00000000 B81300                      mov ax, 0013h
    11 00000003 CD10                        int 10h
    12                                  
    13                                      ; Initialize video memory segment
    14 00000005 B800A0                      mov ax, 0A000h
    15 00000008 8EC0                        mov es, ax
    16                                  
    17                                  main_loop:
    18 0000000A FF06[0400]                  inc word [time]
    19                                  
    20                                      ; Reset position to start of video memory
    21 0000000E 31FF                        xor di, di
    22                                  
    23 00000010 C706[0200]C800              mov word [y], 200
    24                                  y_loop:
    25 00000016 C706[0000]4001              mov word [x], 320
    26                                  x_loop:
    27 0000001C 66A1[0400]                  mov eax, [time]
    28                                  
    29                                      ; Write pixel
    30 00000020 AA                          stosb
    31                                  
    32 00000021 FF0E[0000]                  dec word [x]
    33 00000025 75F5                        jnz x_loop
    34                                  
    35 00000027 FF0E[0200]                  dec word [y]
    36 0000002B 75E9                        jnz y_loop
    37                                  
    38                                      ; Check for keypress to exit
    39 0000002D B401                        mov ah, 1
    40 0000002F CD16                        int 16h
    41 00000031 74D7                        jz main_loop
    42                                  
    43 00000033 C3                          ret
    44                                  
    45                                  ; Data section
    46                                  section .data
    47 00000000 0000                    x           dw  0
    48 00000002 0000                    y           dw  0
    49 00000004 0000                    time        dw  0
    50                                  
